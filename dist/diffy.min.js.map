{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap eeb38a0735c700b8feef","webpack:///./src/index.js","webpack:///./src/Diffy.js","webpack:///./src/worker.js","webpack:///./~/worker-loader/createInlineWorker.js","webpack:///./src/utils.js","webpack:///./src/raf.js","webpack:///./src/capture.js"],"names":["create","resolution","sensitivity","threshold","debug","onFrame","window","Error","tickFn","captureFn","logger_1","logger_2","Diffy","captureConfig","audio","video","width","height","sourceDimensions","w","h","matrix","containerClassName","x","y","bind","currentImageData","previousImageData","resolutionX","resolutionY","debugViewCollapsed","sourceWidth","sourceHeight","worker","initialized","addEventListener","init","blob","videoEl","src","canvas","getContext","drawImage","ctx","translate","scale","frame1","frame2","data1","data","data2","length","buffer","ArrayBuffer","postMessage","blendImageData","set","Uint8ClampedArray","blendCanvasCtx","putImageData","getImageData","compare","i","j","posX","posY","k","cellWidth","cellHeight","cellImageData","cellImageDataLength","cellPixelCount","average","row","push","toCanvas","rawCanvasEl","blend","createMatrix","loop","e","drawBlendImageFromBuffer","initDom","blendCanvasEl","then","forEach","mirror","toVideo","containerEl","document","createElement","className","setAttribute","headerEl","titleEl","innerText","toggleEl","ev","preventDefault","el","classList","remove","add","appendChild","body","node","styles","innerHTML","createElements","injectCssStyles","options","instanceExists","VERSION","createOnceLog","counter","onceLog","log","arguments","$","selector","querySelector","round","number","abs","value","polarize","requestAnimFrame","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","callback","setTimeout","getUserMedia","constraints","successCallback","errorCallback","navigator","webkitGetUserMedia","mozGetUserMedia","Promise","reject","call","mediaDevices","undefined","capture","stream","URL","createObjectURL","catch","name","message","console","error"],"mappings":"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","file":"diffy.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"diffy\"] = factory();\n\telse\n\t\troot[\"diffy\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap eeb38a0735c700b8feef","/* eslint-disable no-console */\n\nimport Diffy from './Diffy';\nimport requestAnimFrame from './raf';\nimport capture from './capture';\n\nconst create = ({ resolution, sensitivity, threshold, debug, onFrame }) => {\n\n  if(!window) {\n    throw new Error(`\n      Diffy.js is meant to be used in the browser. :^)\n      For more info, see: https://github.com/maniart/diffyjs/blob/master/README.md\n    `);\n  }\n\n  if(!'Worker' in window) {\n    throw new Error(`\n      Diffy.js requires Web Workers.\n      It looks like this environment does not support this feature. :(\n      For more info, see: https://github.com/maniart/diffyjs/blob/master/README.md\n    `);\n  }\n\n  return Diffy.create({\n    tickFn: requestAnimFrame,\n    captureFn: capture,\n    resolution,\n    sensitivity,\n    threshold,\n    debug,\n    onFrame\n  });\n\n}\n\nexport default create;\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","import Worker from 'worker-loader?inline!./worker';\nimport { createOnceLog, $, round } from './utils';\n\n// tmp\nconst logger_1 = createOnceLog();\nconst logger_2 = createOnceLog();\n\nexport default class Diffy {\n  constructor({\n    tickFn = () => {},\n    captureFn = () => {},\n    captureConfig = {\n      audio: false,\n      video: {\n        width: 130,\n        height: 100\n      }\n    },\n    debug = false,\n    sourceDimensions = { w: 130, h: 100 },\n    onFrame = (matrix) => {},\n    sensitivity = 0.5,\n    containerClassName = 'diffy--debug-view',\n    resolution = { x: 10, y: 5 }\n  }) {\n\n\n    this.tickFn = tickFn.bind(window);\n    this.captureFn = captureFn;\n\n    this.currentImageData = null;\n    this.previousImageData = null;\n\n    this.resolutionX = resolution.x;\n    this.resolutionY = resolution.y;\n\n    this.sensitivity = sensitivity;\n\n    this.debug = debug;\n    this.containerClassName = containerClassName;\n    this.debugViewCollapsed = false;\n\n    this.captureConfig = captureConfig;\n\n    this.sourceWidth = sourceDimensions.w;\n    this.sourceHeight = sourceDimensions.h;\n\n    this.worker = new Worker;\n\n    this.initialized = false;\n\n    window.addEventListener('load', this.init.bind(this));\n  }\n\n  static instanceExists = false;\n  static VERSION = '1.0.0';\n\n  toVideo(blob, videoEl) {\n    // piping blob to video element\n    videoEl.src = blob;\n  }\n\n  toCanvas(video, canvas) {\n    // piping video to canvas\n    canvas\n      .getContext('2d')\n      .drawImage(video, 0, 0, canvas.width, canvas.height);\n  }\n\n\n  mirror(canvas) {\n    const ctx = canvas.getContext('2d');\n    ctx.translate(canvas.width, 0);\n    ctx.scale(-1, 1);\n    return canvas;\n  }\n\n  compare(frame1, frame2) {\n    const data1 = frame1.data;\n    const data2 = frame2.data;\n    const length = data1.length;\n    const buffer = new ArrayBuffer(length);\n\n    this.worker.postMessage({\n      buffer,\n      data1,\n      data2,\n      sensitivity: this.sensitivity,\n      width: this.sourceWidth,\n      height: this.sourceHeight\n    });\n  }\n\n  drawBlendImageFromBuffer(buffer) {\n    this.blendImageData\n      .data\n      .set(\n        new Uint8ClampedArray(buffer)\n      );\n\n    this.blendCanvasCtx.putImageData(this.blendImageData, 0, 0);\n    this.previousImageData = this.currentImageData;\n  }\n\n  /*\n    blend two consecutive frames\n    returns imageData\n  */\n  blend(canvas) {\n    const ctx = canvas.getContext('2d');\n    const width = canvas.width;\n    const height = canvas.height;\n    this.currentImageData = ctx.getImageData(0, 0, width, height);\n    this.previousImageData = this.previousImageData || ctx.getImageData(0, 0, width, height);\n    this.compare(this.currentImageData, this.previousImageData);\n  }\n\n  createMatrix() {\n    let i;\n    let j;\n    let posX;\n    let posY;\n    let k = 0;\n\n    const matrix = [];\n    const sourceWidth = this.sourceWidth;\n    const sourceHeight = this.sourceHeight;\n    const cellWidth = this.sourceWidth / this.resolutionX;\n    const cellHeight = this.sourceHeight / this.resolutionY;\n\n\n    let cellImageData = null;\n    let cellImageDataLength;\n    let cellPixelCount;\n    let average = 0;\n\n    for(i = 0; i < sourceWidth; i += cellWidth) {\n      let row = [];\n\n      for(j = 0; j < sourceHeight; j += cellHeight) {\n        cellImageData = this.blendCanvasCtx.getImageData(i, j, cellWidth, cellHeight).data;\n\n        /* TODO refactor with bitshifting */\n        cellImageDataLength = cellImageData.length;\n        cellPixelCount = cellImageDataLength / 4;\n        while(k < cellPixelCount) {\n          average += (cellImageData[k * 4] + cellImageData[k * 4 + 1] + cellImageData[k * 4 + 2]) / 3;\n          ++ k;\n        }\n        average = round(average / cellPixelCount);\n        /* push the value in the row */\n        row.push(average);\n        average = 0;\n        k = 0;\n      }\n      matrix.push(row); // store the row in matrix\n    }\n\n    return matrix;\n  }\n\n  loop() {\n    this.toCanvas(this.videoEl, this.rawCanvasEl);\n    this.blend(this.rawCanvasEl);\n    this.onFrame(this.createMatrix());\n    this.tickFn(this.loop.bind(this));\n  }\n\n  init() {\n\n    this.worker.addEventListener('error', (e) => {\n      throw e;\n    });\n\n    this.worker.addEventListener('message', ({ data }) => {\n      this.drawBlendImageFromBuffer(data);\n    });\n\n    this.initDom(this.containerClassName);\n    this.blendCanvasCtx = this.blendCanvasEl.getContext('2d');\n    this.blendImageData = this.blendCanvasCtx.getImageData(0, 0, this.sourceWidth, this.sourceHeight);\n\n    this.captureFn(this.captureConfig).then((blob) => {\n      [this.rawCanvasEl, this.blendCanvasEl].forEach(this.mirror);\n      this.toVideo(blob, this.videoEl);\n      this.loop();\n    });\n    this.initialized = true;\n  }\n\n  createElements(containerClassName) {\n    this.containerEl = document.createElement('div');\n    this.containerEl.className = containerClassName;\n\n    this.videoEl = document.createElement('video');\n    this.videoEl.className = 'video view';\n    this.videoEl.setAttribute('autoplay', '');\n    this.videoEl.width = this.sourceWidth;\n    this.videoEl.height = this.sourceHeight;\n\n    this.rawCanvasEl = document.createElement('canvas');\n    this.rawCanvasEl.className = 'canvas--raw view';\n    this.rawCanvasEl.width = this.sourceWidth;\n    this.rawCanvasEl.height = this.sourceHeight;\n\n    this.blendCanvasEl = document.createElement('canvas');\n    this.blendCanvasEl.className = 'canvas--blend view';\n    this.blendCanvasEl.width = this.sourceWidth;\n    this.blendCanvasEl.height = this.sourceHeight;\n\n    this.headerEl = document.createElement('header');\n    this.headerEl.className = 'header';\n\n    this.titleEl = document.createElement('h1');\n    this.titleEl.className = 'title';\n    this.titleEl.innerText = 'Diffy debug view';\n\n    this.toggleEl = document.createElement('span');\n    this.toggleEl.className = 'toggle';\n    this.toggleEl.innerText = '-';\n\n    this.headerEl.addEventListener('click', (ev) => {\n      ev.preventDefault();\n      [this.videoEl, this.rawCanvasEl, this.blendCanvasEl].forEach((el) => {\n        if (this.debugViewCollapsed) {\n          el.classList.remove('hidden');\n          this.toggleEl.innerText = '-';\n        } else {\n          el.classList.add('hidden');\n          this.toggleEl.innerText = '+';\n        }\n      });\n      this.debugViewCollapsed = !this.debugViewCollapsed;\n    });\n\n    this.headerEl.appendChild(this.toggleEl);\n    this.headerEl.appendChild(this.titleEl);\n\n    this.containerEl.appendChild(this.headerEl);\n    this.containerEl.appendChild(this.videoEl);\n    this.containerEl.appendChild(this.rawCanvasEl);\n    this.containerEl.appendChild(this.blendCanvasEl);\n\n    document.body.appendChild(this.containerEl);\n  }\n\n  injectCssStyles() {\n    const node = document.createElement('style');\n    const containerClassName = this.containerClassName;\n    const styles = `\n      .${containerClassName} {\n        position: fixed;\n        top: 0;\n        left: 0;\n        font-family: monospace;\n        background-color: #000;\n        border: 4px solid #000;\n        color: #fff;\n      }\n      .${containerClassName} .header {\n        width: 100%;\n        background-color: #000;\n        font-size: 16px;\n        cursor: pointer;\n      }\n      .${containerClassName} .title {\n        display: inline;\n        margin-left: 10px;\n        font-weight: 100;\n        font-size: 16px;\n      }\n      .${containerClassName} .toggle {\n        padding: 5px;\n      }\n\n      .${containerClassName} .view {\n        padding: 5px;\n      }\n\n      .${containerClassName} .view.hidden {\n        display: none;\n      }\n\n    `;\n    node.innerHTML = styles;\n    document.body.appendChild(node);\n  }\n\n  initDom(containerClassName) {\n    this.createElements(containerClassName);\n    this.injectCssStyles();\n  }\n\n  static create(options) {\n    if (Diffy.instanceExists) {\n      throw new Error(`\n        Yikes! It seems like a Diffy.js instance already exists on this page. :|\n        For more info, see: https://github.com/maniart/diffyjs/blob/master/README.md\n      `);\n    }\n\n    Diffy.instanceExists = true;\n    return new this(options);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/Diffy.js","module.exports = function() {\n\treturn require(\"!!/Users/maninilchiani/Self/diffyjs/node_modules/worker-loader/createInlineWorker.js\")(\"/******/ (function(modules) { // webpackBootstrap\\n/******/ \\t// The module cache\\n/******/ \\tvar installedModules = {};\\n/******/\\n/******/ \\t// The require function\\n/******/ \\tfunction __webpack_require__(moduleId) {\\n/******/\\n/******/ \\t\\t// Check if module is in cache\\n/******/ \\t\\tif(installedModules[moduleId])\\n/******/ \\t\\t\\treturn installedModules[moduleId].exports;\\n/******/\\n/******/ \\t\\t// Create a new module (and put it into the cache)\\n/******/ \\t\\tvar module = installedModules[moduleId] = {\\n/******/ \\t\\t\\texports: {},\\n/******/ \\t\\t\\tid: moduleId,\\n/******/ \\t\\t\\tloaded: false\\n/******/ \\t\\t};\\n/******/\\n/******/ \\t\\t// Execute the module function\\n/******/ \\t\\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\\n/******/\\n/******/ \\t\\t// Flag the module as loaded\\n/******/ \\t\\tmodule.loaded = true;\\n/******/\\n/******/ \\t\\t// Return the exports of the module\\n/******/ \\t\\treturn module.exports;\\n/******/ \\t}\\n/******/\\n/******/\\n/******/ \\t// expose the modules object (__webpack_modules__)\\n/******/ \\t__webpack_require__.m = modules;\\n/******/\\n/******/ \\t// expose the module cache\\n/******/ \\t__webpack_require__.c = installedModules;\\n/******/\\n/******/ \\t// __webpack_public_path__\\n/******/ \\t__webpack_require__.p = \\\"/\\\";\\n/******/\\n/******/ \\t// Load entry module and return exports\\n/******/ \\treturn __webpack_require__(0);\\n/******/ })\\n/************************************************************************/\\n/******/ ([\\n/* 0 */\\n/***/ function(module, exports, __webpack_require__) {\\n\\n\\t'use strict';\\n\\t\\n\\tvar _utils = __webpack_require__(1);\\n\\t\\n\\tvar buffer = void 0;\\n\\tvar pixelData = void 0;\\n\\tvar data1 = void 0;\\n\\tvar data2 = void 0;\\n\\tvar average1 = void 0;\\n\\tvar average2 = void 0;\\n\\tvar width = void 0;\\n\\tvar height = void 0;\\n\\tvar delta = void 0;\\n\\tvar sensitivity = void 0;\\n\\tvar threshold = void 0;\\n\\t\\n\\tvar createDiffBuffer = function createDiffBuffer(_ref) {\\n\\t  var _ref$data = _ref.data,\\n\\t      buffer = _ref$data.buffer,\\n\\t      data1 = _ref$data.data1,\\n\\t      data2 = _ref$data.data2,\\n\\t      width = _ref$data.width,\\n\\t      height = _ref$data.height,\\n\\t      sensitivity = _ref$data.sensitivity;\\n\\t\\n\\t  var i = 0;\\n\\t\\n\\t  pixelData = new Uint32Array(buffer);\\n\\t  for (var y = 0; y < height; ++y) {\\n\\t    for (var x = 0; x < width; ++x) {\\n\\t      i = y * width + x;\\n\\t      average1 = (data1[i * 4] + data1[i * 4 + 1] + data1[i * 4 + 2]) / 3 / sensitivity;\\n\\t      average2 = (data2[i * 4] + data2[i * 4 + 1] + data2[i * 4 + 2]) / 3 / sensitivity;\\n\\t      delta = (0, _utils.polarize)((0, _utils.abs)(average1 - average2), 0x15);\\n\\t      pixelData[i] = 255 << 24 | // alpha\\n\\t      delta << 16 | // blue\\n\\t      delta << 8 | // green\\n\\t      delta; // red\\n\\t    }\\n\\t  }\\n\\t\\n\\t  postMessage(buffer);\\n\\t};\\n\\t\\n\\tonmessage = createDiffBuffer;\\n\\n/***/ },\\n/* 1 */\\n/***/ function(module, exports) {\\n\\n\\t\\\"use strict\\\";\\n\\t\\n\\tObject.defineProperty(exports, \\\"__esModule\\\", {\\n\\t  value: true\\n\\t});\\n\\t/* eslint-disable no-console */\\n\\t\\n\\t/*\\n\\t  utility function to log only once\\n\\t  useful for logging in loops\\n\\t*/\\n\\tvar createOnceLog = exports.createOnceLog = function createOnceLog() {\\n\\t  var counter = 0;\\n\\t  return function onceLog() {\\n\\t    if (counter < 1) {\\n\\t      var _console;\\n\\t\\n\\t      (_console = console).log.apply(_console, arguments);\\n\\t    }\\n\\t    counter++;\\n\\t  };\\n\\t};\\n\\t\\n\\t/*\\n\\t  utility function to access DOM references\\n\\t*/\\n\\tvar $ = exports.$ = function $(selector) {\\n\\t  return document.querySelector(selector);\\n\\t};\\n\\t\\n\\t/*\\n\\t  bitwise Math.round\\n\\t*/\\n\\tvar round = exports.round = function round(number) {\\n\\t  return number + .5 >> 0;\\n\\t};\\n\\t\\n\\t/*\\n\\t  butwise Math.abs\\n\\t*/\\n\\tvar abs = exports.abs = function abs(value) {\\n\\t  return (value ^ value >> 31) - (value >> 31);\\n\\t};\\n\\t\\n\\t/*\\n\\t  polarize pixel values based on value and threshold\\n\\t*/\\n\\tvar polarize = exports.polarize = function polarize(value, threshold) {\\n\\t  return value > threshold ? 0x00 : 0XFF;\\n\\t};\\n\\n/***/ }\\n/******/ ]);\\n//# sourceMappingURL=b1ad395cf66f550b3622.worker.js.map\", __webpack_public_path__ + \"b1ad395cf66f550b3622.worker.js\");\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/worker-loader?inline!./src/worker.js\n// module id = 3\n// module chunks = 0","// http://stackoverflow.com/questions/10343913/how-to-create-a-web-worker-from-a-string\r\n\r\nvar URL = window.URL || window.webkitURL;\r\nmodule.exports = function(content, url) {\r\n\ttry {\r\n\t\ttry {\r\n\t\t\tvar blob;\r\n\t\t\ttry { // BlobBuilder = Deprecated, but widely implemented\r\n\t\t\t\tvar BlobBuilder = window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder || window.MSBlobBuilder;\r\n\t\t\t\tblob = new BlobBuilder();\r\n\t\t\t\tblob.append(content);\r\n\t\t\t\tblob = blob.getBlob();\r\n\t\t\t} catch(e) { // The proposed API\r\n\t\t\t\tblob = new Blob([content]);\r\n\t\t\t}\r\n\t\t\treturn new Worker(URL.createObjectURL(blob));\r\n\t\t} catch(e) {\r\n\t\t\treturn new Worker('data:application/javascript,' + encodeURIComponent(content));\r\n\t\t}\r\n\t} catch(e) {\r\n\t\treturn new Worker(url);\r\n\t}\r\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/worker-loader/createInlineWorker.js\n// module id = 4\n// module chunks = 0","/* eslint-disable no-console */\n\n/*\n  utility function to log only once\n  useful for logging in loops\n*/\nexport const createOnceLog = () => {\n  let counter = 0;\n  return function onceLog() {\n    if(counter < 1) {\n      console.log(...arguments);\n    }\n    counter ++;\n  }\n}\n\n/*\n  utility function to access DOM references\n*/\nexport const $ = (selector) => document.querySelector(selector);\n\n/*\n  bitwise Math.round\n*/\nexport const round = (number) => (number + .5) >> 0;\n\n/*\n  butwise Math.abs\n*/\nexport const abs = (value) => (value ^ (value >> 31)) - (value >> 31);\n\n\n/*\n  polarize pixel values based on value and threshold\n*/\nexport const polarize = (value, threshold) => (value > threshold) ? 0x00 : 0XFF;\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils.js","/*\n  shim requestAnimationFrame api\n  source: http://www.paulirish.com/2011/requestanimationframe-for-smart-animating/\n*/\nconst requestAnimFrame =\n  window.requestAnimationFrame       ||\n  window.webkitRequestAnimationFrame ||\n  window.mozRequestAnimationFrame    ||\n  window.oRequestAnimationFrame      ||\n  window.msRequestAnimationFrame     ||\n  function(callback) {\n    window.setTimeout(callback, 1000 / 60);\n  };\n\nexport default requestAnimFrame;\n\n\n\n// WEBPACK FOOTER //\n// ./src/raf.js","/* eslint-disable no-unused-vars */\n/* eslint-disable no-console */\n/*\n  shim getUserMedia with a Promise api\n  source: https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia\n*/\nconst getUserMedia = (constraints, successCallback, errorCallback) => {\n\n  // First get a hold of getUserMedia, if present\n  const getUserMedia = (navigator.getUserMedia ||\n      navigator.webkitGetUserMedia ||\n      navigator.mozGetUserMedia);\n\n  // Some browsers just don't implement it - return a rejected promise with an error\n  // to keep a consistent interface\n  if(!getUserMedia) {\n    return Promise.reject(new Error('getUserMedia is not implemented in this browser'));\n  }\n\n  // Otherwise, wrap the call to the old navigator.getUserMedia with a Promise\n  return new Promise((successCallback, errorCallback) => {\n    getUserMedia.call(navigator, constraints, successCallback, errorCallback);\n  });\n\n}\n\n// Older browsers might not implement mediaDevices at all, so we set an empty object first\nif(navigator.mediaDevices === undefined) {\n  navigator.mediaDevices = {};\n}\n\n// Some browsers partially implement mediaDevices. We can't just assign an object\n// with getUserMedia as it would overwrite existing properties.\n// Here, we will just add the getUserMedia property if it's missing.\nif(navigator.mediaDevices.getUserMedia === undefined) {\n  navigator.mediaDevices.getUserMedia = getUserMedia;\n}\n\n/*\n  capture from camera\n  returns objectUrl\n */\nconst capture = (constraints) => {\n  return navigator.mediaDevices.getUserMedia(constraints)\n    .then((stream) => window.URL.createObjectURL(stream))\n    .catch(({ name, message }) => console.error(`${name} : ${message}`));\n}\n\nexport default capture;\n\n\n\n// WEBPACK FOOTER //\n// ./src/capture.js"],"sourceRoot":""}