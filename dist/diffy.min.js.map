{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap eb649479353dd5c448f1","webpack:///./src/index.js","webpack:///./src/Diffy.js","webpack:///./src/raf.js","webpack:///./src/capture.js","webpack:///./src/utils.js"],"names":["create","resolution","x","y","console","log","tickFn","captureFn","debug","Diffy","containerClassName","currentImageData","previousImageData","resolutionX","resolutionY","constraints","audio","video","width","height","window","addEventListener","init","bind","requestAnimFrame","tick","createElements","container","document","createElement","className","rawCanvas","blendCanvas","header","title","innerText","toggle","appendChild","body","options","instanceExists","Error","bool","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","callback","setTimeout","getUserMedia","successCallback","errorCallback","navigator","webkitGetUserMedia","mozGetUserMedia","Promise","reject","call","mediaDevices","undefined","capture","then","stream","URL","createObjectURL","catch","name","message","error","createOnceLog","counter","onceLog","arguments","$","selector","querySelector","round","number"],"mappings":"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","file":"diffy.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"diffy\"] = factory();\n\telse\n\t\troot[\"diffy\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap eb649479353dd5c448f1","/* eslint-disable no-console */\n\nimport Diffy from './Diffy';\nimport requestAnimFrame from './raf';\nimport capture from './capture';\nimport {\n  createOnceLog,\n  $,\n  round\n} from './utils';\n\n\nexport const create = ({ resolution = {x: 10, y: 5} }) => {\n  console.log('Create called');\n  return Diffy.create({\n    tickFn: requestAnimFrame,\n    captureFn: capture,\n    debug: true,\n    resolution\n  });\n\n}\n\n\n// /**/\n// const $debug = $('#diffy-debug');\n\n// /**/\n// const $toggle = $('#diffy-toggle');\n\n// /**/\n// const $video = $('#diffy-video');\n\n// /**/\n// const $rawCanvas = $('#diffy-raw-canvas');\n\n// /* */\n// const rawCtx = $rawCanvas.getContext('2d');\n\n// /* */\n// const rawWidth = $rawCanvas.width;\n\n// /* */\n// const rawHeight = $rawHeight.height;\n\n// /* */\n// const $blendCanvas = $('#diffy-blend-canvas');\n\n// /* */\n// const blendCtx = $blendCanvas.getContext('2d');\n\n// /* */\n// const blendWidth = $blendCanvas.width;\n\n// /* */\n// const blendHeight = $blendCanvas.height;\n\n// /* */\n// const blendImageData = blendCtx.getImageData(0, 0, blendWidth, blendHeight);\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","export default class Diffy {\n  constructor({\n    tickFn,\n    captureFn,\n    debug = false,\n    containerClassName = 'diffy--debug-view',\n    resolution: { x, y }\n  }) {\n\n    this.tickFn = tickFn;\n    this.captureFn = captureFn;\n\n    this.currentImageData = null;\n    this.previousImageData = null;\n\n    this.resolutionX = x;\n    this.resolutionY = y;\n\n    this.debug = debug;\n    this.containerClassName = containerClassName;\n\n    this.constraints = {\n      audio: false,\n      video: {\n        width: 260,\n        height: 200\n      }\n    };\n\n    console.log('tickFn: ', this.tickFn);\n    console.log('captureFn: ', this.captureFn);\n    console.log('debug: ', this.debug);\n    console.log('className: ', this.containerClassName);\n    console.log('resolution: ', this.resolutionX, this.resolutionY);\n\n    window.addEventListener('load', this.init.bind(this))\n\n  }\n\n  toVideo() {\n\n  }\n\n  toCanvas() {\n\n  }\n\n\n\n  tick() {\n    requestAnimFrame(this.tick);\n  }\n\n  init() {\n    console.log('DOM ready. Init...');\n    this.createElements(this.containerClassName);\n  }\n\n  createElements(containerClassName) {\n    const container = document.createElement('div');\n    container.className = containerClassName;\n\n    const video = document.createElement('video');\n    video.className = 'debug--video';\n\n    const rawCanvas = document.createElement('canvas');\n    rawCanvas.className = 'debug--raw-canvas';\n\n    const blendCanvas = document.createElement('div');\n    blendCanvas.className = 'debug--blend-canvas';\n\n    const header = document.createElement('div');\n    header.className = 'debug--header';\n\n    const title = document.createElement('h6');\n    title.className = 'debug--title';\n    title.innerText = 'diffy debug view';\n\n    const toggle = document.createElement('span');\n    toggle.innerText = '-';\n    header.appendChild(toggle);\n    header.appendChild(title);\n\n    container.appendChild(header);\n    container.appendChild(video);\n    container.appendChild(rawCanvas);\n    container.appendChild(blendCanvas);\n\n    document.body.appendChild(container);\n  }\n\n\n  static get VERSION() {\n    return '1.0.0';\n  }\n\n  static get instanceExists() {\n    return false;\n  }\n\n  static set instanceExists(bool) {\n    Diffy.instanceExists = bool;\n  }\n\n\n  static create(options) {\n    if(Diffy.instanceExists) {\n      throw new Error(`It seems a diffy instance\n      already exists on this page.`);\n    }\n\n    return new this(options);\n    Diffy.instanceExists = true;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/Diffy.js","/*\n  shim requestAnimationFrame api\n  source: http://www.paulirish.com/2011/requestanimationframe-for-smart-animating/\n*/\nconst requestAnimFrame =\n  window.requestAnimationFrame       ||\n  window.webkitRequestAnimationFrame ||\n  window.mozRequestAnimationFrame    ||\n  window.oRequestAnimationFrame      ||\n  window.msRequestAnimationFrame     ||\n  function(callback) {\n    window.setTimeout(callback, 1000 / 60);\n  };\n\nexport default requestAnimFrame;\n\n\n\n// WEBPACK FOOTER //\n// ./src/raf.js","/* eslint-disable no-unused-vars */\n/* eslint-disable no-console */\n/*\n  shim getUserMedia with a Promise api\n  source: https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia\n*/\nconst getUserMedia = (constraints, successCallback, errorCallback) => {\n\n  // First get a hold of getUserMedia, if present\n  const getUserMedia = (navigator.getUserMedia ||\n      navigator.webkitGetUserMedia ||\n      navigator.mozGetUserMedia);\n\n  // Some browsers just don't implement it - return a rejected promise with an error\n  // to keep a consistent interface\n  if(!getUserMedia) {\n    return Promise.reject(new Error('getUserMedia is not implemented in this browser'));\n  }\n\n  // Otherwise, wrap the call to the old navigator.getUserMedia with a Promise\n  return new Promise((successCallback, errorCallback) => {\n    getUserMedia.call(navigator, constraints, successCallback, errorCallback);\n  });\n\n}\n\n// Older browsers might not implement mediaDevices at all, so we set an empty object first\nif(navigator.mediaDevices === undefined) {\n  navigator.mediaDevices = {};\n}\n\n// Some browsers partially implement mediaDevices. We can't just assign an object\n// with getUserMedia as it would overwrite existing properties.\n// Here, we will just add the getUserMedia property if it's missing.\nif(navigator.mediaDevices.getUserMedia === undefined) {\n  navigator.mediaDevices.getUserMedia = getUserMedia;\n}\n\n/*\n  capture from camera\n  returns objectUrl\n */\nconst capture = (constraints) => {\n  return navigator.mediaDevices.getUserMedia(constraints)\n    .then((stream) => window.URL.createObjectURL(stream))\n    .catch(({ name, message }) => console.error(`${name} : ${message}`));\n}\n\nexport default capture;\n\n\n\n// WEBPACK FOOTER //\n// ./src/capture.js","/* eslint-disable no-console */\n\n/*\n  utility function to log only once\n  useful for logging in loops\n*/\nexport const createOnceLog = () => {\n  let counter = 0;\n  return function onceLog() {\n    if(counter < 1) {\n      console.log(...arguments);\n    }\n    counter ++;\n  }\n}\n\n/*\n  utility function for getting DOM references\n  return DOM Object\n*/\nexport const $ = (selector) => document.querySelector(selector);\n\n/*\n  bitwise Math.round\n  returns number\n*/\nexport const round = (number) => (number + .5) >> 0;\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils.js"],"sourceRoot":""}