{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///diffy.min.js","webpack:///webpack/bootstrap 275379919d2da25a6fea","webpack:///./src/index.js","webpack:///./src/Diffy.js","webpack:///./src/worker.js","webpack:///./~/worker-loader/createInlineWorker.js","webpack:///./src/utils.js","webpack:///./src/raf.js","webpack:///./src/capture.js"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","_interopRequireDefault","obj","__esModule","default","Object","defineProperty","value","create","undefined","_Diffy","_Diffy2","_raf","_raf2","_capture","_capture2","_ref","resolution","sensitivity","debug","onFrame","window","Error","tickFn","captureFn","_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","protoProps","staticProps","prototype","_worker","_worker2","_utils","Diffy","createOnceLog","_ref$tickFn","_ref$captureFn","_ref$captureConfig","captureConfig","audio","video","width","height","_ref$debug","_ref$sourceDimensions","sourceDimensions","w","h","_ref$onFrame","matrix","_ref$sensitivity","_ref$containerClassNa","containerClassName","_ref$resolution","x","y","bind","currentImageData","previousImageData","resolutionX","resolutionY","debugViewCollapsed","sourceWidth","sourceHeight","worker","initialized","addEventListener","init","blob","videoEl","src","canvas","getContext","drawImage","ctx","translate","scale","frame1","frame2","data1","data","data2","buffer","ArrayBuffer","postMessage","blendImageData","set","Uint8ClampedArray","blendCanvasCtx","putImageData","getImageData","compare","j","k","cellWidth","cellHeight","cellImageData","cellImageDataLength","cellPixelCount","average","row","round","push","toCanvas","rawCanvasEl","blend","createMatrix","loop","_this","e","_ref2","drawBlendImageFromBuffer","initDom","blendCanvasEl","then","forEach","mirror","toVideo","_this2","containerEl","document","createElement","className","setAttribute","headerEl","titleEl","innerText","toggleEl","ev","preventDefault","el","classList","remove","add","appendChild","body","node","styles","innerHTML","createElements","injectCssStyles","options","instanceExists","VERSION","URL","webkitURL","content","url","BlobBuilder","WebKitBlobBuilder","MozBlobBuilder","MSBlobBuilder","append","getBlob","Blob","Worker","createObjectURL","encodeURIComponent","counter","_console","console","log","apply","arguments","$","selector","querySelector","number","abs","polarize","threshold","requestAnimFrame","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","callback","setTimeout","getUserMedia","constraints","successCallback","errorCallback","navigator","webkitGetUserMedia","mozGetUserMedia","Promise","reject","mediaDevices","capture","stream","catch","name","message","error"],"mappings":"CAAA,SAAAA,EAAAC,GACA,gBAAAC,UAAA,gBAAAC,QACAA,OAAAD,QAAAD,IACA,kBAAAG,gBAAAC,IACAD,UAAAH,GACA,gBAAAC,SACAA,QAAA,MAAAD,IAEAD,EAAA,MAAAC,KACCK,KAAA,WACD,MCAgB,UAAUC,GCN1B,QAAAC,GAAAC,GAGA,GAAAC,EAAAD,GACA,MAAAC,GAAAD,GAAAP,OAGA,IAAAC,GAAAO,EAAAD,IACAP,WACAS,GAAAF,EACAG,QAAA,EAUA,OANAL,GAAAE,GAAAI,KAAAV,EAAAD,QAAAC,IAAAD,QAAAM,GAGAL,EAAAS,QAAA,EAGAT,EAAAD,QAvBA,GAAAQ,KAqCA,OATAF,GAAAM,EAAAP,EAGAC,EAAAO,EAAAL,EAGAF,EAAAQ,EAAA,IAGAR,EAAA,KDgBM,SAASL,EAAQD,EAASM,GAE/BL,EAAOD,QAAUM,EAAoB,IAKhC,SAASL,EAAQD,EAASM,GAE/B,YAmBA,SAASS,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,QAASF,GAjBvFG,OAAOC,eAAepB,EAAS,cAC7BqB,OAAO,IAETrB,EAAQsB,OAASC,MElElB,IAAAC,GAAAlB,EAAA,GFsEKmB,EAAUV,EAAuBS,GErEtCE,EAAApB,EAAA,GFyEKqB,EAAQZ,EAAuBW,GExEpCE,EAAAtB,EAAA,GF4EKuB,EAAYd,EAAuBa,EE1E3BN,UAAS,SAAAQ,GAAiD,GAA9CC,GAA8CD,EAA9CC,WAAYC,EAAkCF,EAAlCE,YAAaC,EAAqBH,EAArBG,MAAOC,EAAcJ,EAAdI,OAEvD,KAAIC,OACF,KAAM,IAAIC,OAAJ,qJAMR,KAAG,IAAaD,QACd,KAAM,IAAIC,OAAJ,2MAOR,OAAOX,GAAAP,QAAMI,QACXe,iBACAC,oBACAP,aACAC,cACAC,QACAC,cFkFE,SAASjC,EAAQD,EAASM,GAE/B,YAcA,SAASS,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,QAASF,GAEvF,QAASuB,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAdhHvB,OAAOC,eAAepB,EAAS,cAC7BqB,OAAO,GAGT,IAAIsB,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CAAE,GAAIE,GAAaH,EAAMC,EAAIE,GAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAWE,cAAe,EAAU,SAAWF,KAAYA,EAAWG,UAAW,GAAMjC,OAAOC,eAAeyB,EAAQI,EAAWI,IAAKJ,IAAiB,MAAO,UAAUR,EAAaa,EAAYC,GAAiJ,MAA9HD,IAAYV,EAAiBH,EAAYe,UAAWF,GAAiBC,GAAaX,EAAiBH,EAAac,GAAqBd,MGvHjiBgB,EAAAnD,EAAA,GH2HKoD,EAAW3C,EAAuB0C,GG1HvCE,EAAArD,EAAA,GAMqBsD,IAHJ,EAAAD,EAAAE,kBACA,EAAAF,EAAAE,iBHkIJ,WG/HX,QAAAD,GAAA9B,GAgBG,GAAAgC,GAAAhC,EAfDO,SAeCd,SAAAuC,EAfQ,aAeRA,EAAAC,EAAAjC,EAdDQ,YAcCf,SAAAwC,EAdW,aAcXA,EAAAC,EAAAlC,EAbDmC,gBAaC1C,SAAAyC,GAZCE,OAAO,EACPC,OACEC,MAAO,IACPC,OAAQ,MASXL,EAAAM,EAAAxC,EANDG,QAMCV,SAAA+C,KAAAC,EAAAzC,EALD0C,mBAKCjD,SAAAgD,GALoBE,EAAG,IAAKC,EAAG,KAK/BH,EAAAI,EAAA7C,EAJDI,UAICX,SAAAoD,EAJS,SAACC,KAIVD,EAAAE,EAAA/C,EAHDE,cAGCT,SAAAsD,EAHa,GAGbA,EAAAC,EAAAhD,EAFDiD,qBAECxD,SAAAuD,EAFoB,oBAEpBA,EAAAE,EAAAlD,EADDC,aACCR,SAAAyD,GADcC,EAAG,GAAIC,EAAG,GACxBF,CAAAzC,GAAAnC,KAAAwD,GAGDxD,KAAKiC,OAASA,EAAO8C,KAAKhD,QAC1B/B,KAAKkC,UAAYA,EAEjBlC,KAAK8B,QAAUA,EAEf9B,KAAKgF,iBAAmB,KACxBhF,KAAKiF,kBAAoB,KAEzBjF,KAAKkF,YAAcvD,EAAWkD,EAC9B7E,KAAKmF,YAAcxD,EAAWmD,EAE9B9E,KAAK4B,YAAcA,EAEnB5B,KAAK6B,MAAQA,EACb7B,KAAK2E,mBAAqBA,EAC1B3E,KAAKoF,oBAAqB,EAE1BpF,KAAK6D,cAAgBA,EAErB7D,KAAKqF,YAAcjB,EAAiBC,EACpCrE,KAAKsF,aAAelB,EAAiBE,EAErCtE,KAAKuF,OAAS,GAAAjC,GAAAxC,QAEdd,KAAKwF,aAAc,EAEnBzD,OAAO0D,iBAAiB,OAAQzF,KAAK0F,KAAKX,KAAK/E,OHiXhD,MArOAuC,GAAaiB,IACXP,IAAK,UACLhC,MAAO,SGxIF0E,EAAMC,GAEZA,EAAQC,IAAMF,KH2Ib1C,IAAK,WACLhC,MAAO,SGzID8C,EAAO+B,GAEdA,EACGC,WAAW,MACXC,UAAUjC,EAAO,EAAG,EAAG+B,EAAO9B,MAAO8B,EAAO7B,WH0I9ChB,IAAK,SACLhC,MAAO,SGvIH6E,GACL,GAAMG,GAAMH,EAAOC,WAAW,KAG9B,OAFAE,GAAIC,UAAUJ,EAAO9B,MAAO,GAC5BiC,EAAIE,OAAM,EAAI,GACPL,KH0IN7C,IAAK,UACLhC,MAAO,SGxIFmF,EAAQC,GACd,GAAMC,GAAQF,EAAOG,KACfC,EAAQH,EAAOE,KACf3D,EAAS0D,EAAM1D,OACf6D,EAAS,GAAIC,aAAY9D,EAE/B5C,MAAKuF,OAAOoB,aACVF,SACAH,QACAE,QACA5E,YAAa5B,KAAK4B,YAClBoC,MAAOhE,KAAKqF,YACZpB,OAAQjE,KAAKsF,kBH4IdrC,IAAK,2BACLhC,MAAO,SGzIewF,GACvBzG,KAAK4G,eACFL,KACAM,IACC,GAAIC,mBAAkBL,IAG1BzG,KAAK+G,eAAeC,aAAahH,KAAK4G,eAAgB,EAAG,GACzD5G,KAAKiF,kBAAoBjF,KAAKgF,oBH8I7B/B,IAAK,QACLhC,MAAO,SGxIJ6E,GACJ,GAAMG,GAAMH,EAAOC,WAAW,MACxB/B,EAAQ8B,EAAO9B,MACfC,EAAS6B,EAAO7B,MACtBjE,MAAKgF,iBAAmBiB,EAAIgB,aAAa,EAAG,EAAGjD,EAAOC,GACtDjE,KAAKiF,kBAAoBjF,KAAKiF,mBAAqBgB,EAAIgB,aAAa,EAAG,EAAGjD,EAAOC,GACjFjE,KAAKkH,QAAQlH,KAAKgF,iBAAkBhF,KAAKiF,sBH2IxChC,IAAK,eACLhC,MAAO,WGxIR,GAAI0B,UACAwE,SAGAC,EAAI,EAEF5C,KACAa,EAAcrF,KAAKqF,YACnBC,EAAetF,KAAKsF,aACpB+B,EAAYrH,KAAKqF,YAAcrF,KAAKkF,YACpCoC,EAAatH,KAAKsF,aAAetF,KAAKmF,YAGxCoC,EAAgB,KAChBC,SACAC,SACAC,EAAU,CAEd,KAAI/E,EAAI,EAAGA,EAAI0C,EAAa1C,GAAK0E,EAAW,CAC1C,GAAIM,KAEJ,KAAIR,EAAI,EAAGA,EAAI7B,EAAc6B,GAAKG,EAAY,CAM5C,IALAC,EAAgBvH,KAAK+G,eAAeE,aAAatE,EAAGwE,EAAGE,EAAWC,GAAYf,KAG9EiB,EAAsBD,EAAc3E,OACpC6E,EAAiBD,EAAsB,EACjCJ,EAAIK,GACRC,IAAYH,EAAkB,EAAJH,GAASG,EAAkB,EAAJH,EAAQ,GAAKG,EAAkB,EAAJH,EAAQ,IAAM,IACvFA,CAELM,IAAU,EAAAnE,EAAAqE,OAAMF,EAAUD,GAE1BE,EAAIE,KAAKH,GACTA,EAAU,EACVN,EAAI,EAEN5C,EAAOqD,KAAKF,GAGd,MAAOnD,MH2INvB,IAAK,OACLhC,MAAO,WGxIRjB,KAAK8H,SAAS9H,KAAK4F,QAAS5F,KAAK+H,aACjC/H,KAAKgI,MAAMhI,KAAK+H,aAChB/H,KAAK8B,QAAQ9B,KAAKiI,gBAClBjI,KAAKiC,OAAOjC,KAAKkI,KAAKnD,KAAK/E,UH4I1BiD,IAAK,OACLhC,MAAO,WG1IH,GAAAkH,GAAAnI,IAELA,MAAKuF,OAAOE,iBAAiB,QAAS,SAAC2C,GACrC,KAAMA,KAGRpI,KAAKuF,OAAOE,iBAAiB,UAAW,SAAA4C,GAAc,GAAX9B,GAAW8B,EAAX9B,IACzC4B,GAAKG,yBAAyB/B,KAGhCvG,KAAKuI,QAAQvI,KAAK2E,oBAClB3E,KAAK+G,eAAiB/G,KAAKwI,cAAczC,WAAW,MACpD/F,KAAK4G,eAAiB5G,KAAK+G,eAAeE,aAAa,EAAG,EAAGjH,KAAKqF,YAAarF,KAAKsF,cAEpFtF,KAAKkC,UAAUlC,KAAK6D,eAAe4E,KAAK,SAAC9C,IACtCwC,EAAKJ,YAAaI,EAAKK,eAAeE,QAAQP,EAAKQ,QACpDR,EAAKS,QAAQjD,EAAMwC,EAAKvC,SACxBuC,EAAKD,SAEPlI,KAAKwF,aAAc,KHgJlBvC,IAAK,iBACLhC,MAAO,SG9IK0D,GAAoB,GAAAkE,GAAA7I,IACjCA,MAAK8I,YAAcC,SAASC,cAAc,OAC1ChJ,KAAK8I,YAAYG,UAAYtE,EAE7B3E,KAAK4F,QAAUmD,SAASC,cAAc,SACtChJ,KAAK4F,QAAQqD,UAAY,aACzBjJ,KAAK4F,QAAQsD,aAAa,WAAY,IACtClJ,KAAK4F,QAAQ5B,MAAQhE,KAAKqF,YAC1BrF,KAAK4F,QAAQ3B,OAASjE,KAAKsF,aAE3BtF,KAAK+H,YAAcgB,SAASC,cAAc,UAC1ChJ,KAAK+H,YAAYkB,UAAY,mBAC7BjJ,KAAK+H,YAAY/D,MAAQhE,KAAKqF,YAC9BrF,KAAK+H,YAAY9D,OAASjE,KAAKsF,aAE/BtF,KAAKwI,cAAgBO,SAASC,cAAc,UAC5ChJ,KAAKwI,cAAcS,UAAY,qBAC/BjJ,KAAKwI,cAAcxE,MAAQhE,KAAKqF,YAChCrF,KAAKwI,cAAcvE,OAASjE,KAAKsF,aAEjCtF,KAAKmJ,SAAWJ,SAASC,cAAc,UACvChJ,KAAKmJ,SAASF,UAAY,SAE1BjJ,KAAKoJ,QAAUL,SAASC,cAAc,MACtChJ,KAAKoJ,QAAQH,UAAY,QACzBjJ,KAAKoJ,QAAQC,UAAY,mBAEzBrJ,KAAKsJ,SAAWP,SAASC,cAAc,QACvChJ,KAAKsJ,SAASL,UAAY,SAC1BjJ,KAAKsJ,SAASD,UAAY,IAE1BrJ,KAAKmJ,SAAS1D,iBAAiB,QAAS,SAAC8D,GACvCA,EAAGC,kBACFX,EAAKjD,QAASiD,EAAKd,YAAac,EAAKL,eAAeE,QAAQ,SAACe,GACxDZ,EAAKzD,oBACPqE,EAAGC,UAAUC,OAAO,UACpBd,EAAKS,SAASD,UAAY,MAE1BI,EAAGC,UAAUE,IAAI,UACjBf,EAAKS,SAASD,UAAY,OAG9BR,EAAKzD,oBAAsByD,EAAKzD,qBAGlCpF,KAAKmJ,SAASU,YAAY7J,KAAKsJ,UAC/BtJ,KAAKmJ,SAASU,YAAY7J,KAAKoJ,SAE/BpJ,KAAK8I,YAAYe,YAAY7J,KAAKmJ,UAClCnJ,KAAK8I,YAAYe,YAAY7J,KAAK4F,SAClC5F,KAAK8I,YAAYe,YAAY7J,KAAK+H,aAClC/H,KAAK8I,YAAYe,YAAY7J,KAAKwI,eAElCO,SAASe,KAAKD,YAAY7J,KAAK8I,aAE1B9I,KAAK6B,OACR7B,KAAK8I,YAAYY,UAAUE,IAAI,aHoJhC3G,IAAK,kBACLhC,MAAO,WGhJR,GAAM8I,GAAOhB,SAASC,cAAc,SAC9BrE,EAAqB3E,KAAK2E,mBAC1BqF,cACDrF,EADC,6MAUDA,EAVC,0IAgBDA,EAhBC,yIAsBDA,EAtBC,wDA0BDA,EA1BC,sDA8BDA,EA9BC,8DAkCDA,EAlCC,kDAsCNoF,GAAKE,UAAYD,EACjBjB,SAASe,KAAKD,YAAYE,MH+GzB9G,IAAK,UACLhC,MAAO,SG7GF0D,GACN3E,KAAKkK,eAAevF,GACpB3E,KAAKmK,uBHgHJlH,IAAK,SACLhC,MAAO,SG9GImJ,GACZ,GAAI5G,EAAM6G,eACR,KAAM,IAAIrI,OAAJ,mLAOR,OADAwB,GAAM6G,gBAAiB,EAChB,GAAIrK,MAAKoK,OH+GV5G,KG/ZWA,GAiDZ6G,gBAAiB,EAjDL7G,EAkDZ8G,QAAU,QHkXlB1K,EAAQkB,QGpaY0C,GHwaf,SAAS3D,EAAQD,EAASM,GI/ahCL,EAAAD,QAAA,WACA,MAAAM,GAAA,+gCAAikCA,EAAAQ,EAAA,oCJsb3jC,SAASb,EAAQD,GKrbvB,GAAA2K,GAAAxI,OAAAwI,KAAAxI,OAAAyI,SACA3K,GAAAD,QAAA,SAAA6K,EAAAC,GACA,IACA,IACA,GAAA/E,EACA,KACA,GAAAgF,GAAA5I,OAAA4I,aAAA5I,OAAA6I,mBAAA7I,OAAA8I,gBAAA9I,OAAA+I,aACAnF,GAAA,GAAAgF,GACAhF,EAAAoF,OAAAN,GACA9E,IAAAqF,UACI,MAAA5C,GACJzC,EAAA,GAAAsF,OAAAR,IAEA,UAAAS,QAAAX,EAAAY,gBAAAxF,IACG,MAAAyC,GACH,UAAA8C,QAAA,+BAAAE,mBAAAX,KAEE,MAAArC,GACF,UAAA8C,QAAAR,ML+bM,SAAS7K,EAAQD,GAEtB,YAEAmB,QAAOC,eAAepB,EAAS,cAC7BqB,OAAO,GMldGwC,iBAAgB,WAC3B,GAAI4H,GAAU,CACd,OAAO,YACL,GAAGA,EAAU,EAAG,IAAAC,IACdA,EAAAC,SAAQC,IAARC,MAAAH,EAAeI,WAEjBL,MAOSM,IAAI,SAACC,GAAD,MAAc7C,UAAS8C,cAAcD,IAKzChE,QAAQ,SAACkE,GAAD,MAAaA,GAAS,IAAO,GAKrCC,MAAM,SAAC9K,GAAD,OAAYA,EAASA,GAAS,KAAQA,GAAS,KAMrD+K,WAAW,SAAC/K,EAAOgL,GAAR,MAAuBhL,GAAQgL,EAAa,EAAO,MNuerE,SAASpM,EAAQD,GAEtB,YAEAmB,QAAOC,eAAepB,EAAS,cAC7BqB,OAAO,GO3gBV,IAAMiL,GACJnK,OAAOoK,uBACPpK,OAAOqK,6BACPrK,OAAOsK,0BACPtK,OAAOuK,wBACPvK,OAAOwK,yBACP,SAASC,GACPzK,OAAO0K,WAAWD,EAAU,IAAO,IP8gBtC5M,GAAQkB,QO3gBMoL,GP+gBT,SAASrM,EAAQD,GAEtB,YAEAmB,QAAOC,eAAepB,EAAS,cAC7BqB,OAAO,GQ5hBV,IAAMyL,GAAe,QAAAA,GAACC,EAAaC,EAAiBC,GAGlD,GAAMH,GAAgBI,UAAUJ,cAC5BI,UAAUC,oBACVD,UAAUE,eAId,OAAIN,GAKG,GAAIO,SAAQ,SAACL,EAAiBC,GACnCH,EAAanM,KAAKuM,UAAWH,EAAaC,EAAiBC,KALpDI,QAAQC,OAAO,GAAIlL,OAAM,oDAWNb,UAA3B2L,UAAUK,eACXL,UAAUK,iBAM+BhM,SAAxC2L,UAAUK,aAAaT,eACxBI,UAAUK,aAAaT,aAAeA,EAOxC,IAAMU,GAAU,SAACT,GACf,MAAOG,WAAUK,aAAaT,aAAaC,GACxClE,KAAK,SAAC4E,GAAD,MAAYtL,QAAOwI,IAAIY,gBAAgBkC,KAC5CC,MAAM,SAAA5L,GAAA,GAAG6L,GAAH7L,EAAG6L,KAAMC,EAAT9L,EAAS8L,OAAT,OAAuBjC,SAAQkC,MAASF,EAAjB,MAA2BC,KRwiB5D5N,GAAQkB,QQriBMsM","file":"diffy.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Diffy\"] = factory();\n\telse\n\t\troot[\"Diffy\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Diffy\"] = factory();\n\telse\n\t\troot[\"Diffy\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"/\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__(1);\n\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.create = undefined;\n\t\n\tvar _Diffy = __webpack_require__(2);\n\t\n\tvar _Diffy2 = _interopRequireDefault(_Diffy);\n\t\n\tvar _raf = __webpack_require__(6);\n\t\n\tvar _raf2 = _interopRequireDefault(_raf);\n\t\n\tvar _capture = __webpack_require__(7);\n\t\n\tvar _capture2 = _interopRequireDefault(_capture);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar create = exports.create = function create(_ref) {\n\t  var resolution = _ref.resolution,\n\t      sensitivity = _ref.sensitivity,\n\t      debug = _ref.debug,\n\t      onFrame = _ref.onFrame;\n\t\n\t\n\t  if (!window) {\n\t    throw new Error('\\n      Diffy.js is meant to be used in the browser. :^)\\n      For more info, see: https://github.com/maniart/diffyjs/blob/master/README.md\\n    ');\n\t  }\n\t\n\t  if (!'Worker' in window) {\n\t    throw new Error('\\n      Diffy.js requires Web Workers.\\n      It looks like this environment does not support this feature. :(\\n      For more info, see: https://github.com/maniart/diffyjs/blob/master/README.md\\n    ');\n\t  }\n\t\n\t  return _Diffy2.default.create({\n\t    tickFn: _raf2.default,\n\t    captureFn: _capture2.default,\n\t    resolution: resolution,\n\t    sensitivity: sensitivity,\n\t    debug: debug,\n\t    onFrame: onFrame\n\t  });\n\t}; /* eslint-disable no-console */\n\n/***/ },\n/* 2 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _worker = __webpack_require__(3);\n\t\n\tvar _worker2 = _interopRequireDefault(_worker);\n\t\n\tvar _utils = __webpack_require__(5);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t// tmp\n\tvar logger_1 = (0, _utils.createOnceLog)();\n\tvar logger_2 = (0, _utils.createOnceLog)();\n\t\n\tvar Diffy = function () {\n\t  function Diffy(_ref) {\n\t    var _ref$tickFn = _ref.tickFn,\n\t        tickFn = _ref$tickFn === undefined ? function () {} : _ref$tickFn,\n\t        _ref$captureFn = _ref.captureFn,\n\t        captureFn = _ref$captureFn === undefined ? function () {} : _ref$captureFn,\n\t        _ref$captureConfig = _ref.captureConfig,\n\t        captureConfig = _ref$captureConfig === undefined ? {\n\t      audio: false,\n\t      video: {\n\t        width: 130,\n\t        height: 100\n\t      }\n\t    } : _ref$captureConfig,\n\t        _ref$debug = _ref.debug,\n\t        debug = _ref$debug === undefined ? false : _ref$debug,\n\t        _ref$sourceDimensions = _ref.sourceDimensions,\n\t        sourceDimensions = _ref$sourceDimensions === undefined ? { w: 130, h: 100 } : _ref$sourceDimensions,\n\t        _ref$onFrame = _ref.onFrame,\n\t        onFrame = _ref$onFrame === undefined ? function (matrix) {} : _ref$onFrame,\n\t        _ref$sensitivity = _ref.sensitivity,\n\t        sensitivity = _ref$sensitivity === undefined ? 0.2 : _ref$sensitivity,\n\t        _ref$containerClassNa = _ref.containerClassName,\n\t        containerClassName = _ref$containerClassNa === undefined ? 'diffy--debug-view' : _ref$containerClassNa,\n\t        _ref$resolution = _ref.resolution,\n\t        resolution = _ref$resolution === undefined ? { x: 10, y: 5 } : _ref$resolution;\n\t\n\t    _classCallCheck(this, Diffy);\n\t\n\t    this.tickFn = tickFn.bind(window);\n\t    this.captureFn = captureFn;\n\t\n\t    this.onFrame = onFrame;\n\t\n\t    this.currentImageData = null;\n\t    this.previousImageData = null;\n\t\n\t    this.resolutionX = resolution.x;\n\t    this.resolutionY = resolution.y;\n\t\n\t    this.sensitivity = sensitivity;\n\t\n\t    this.debug = debug;\n\t    this.containerClassName = containerClassName;\n\t    this.debugViewCollapsed = false;\n\t\n\t    this.captureConfig = captureConfig;\n\t\n\t    this.sourceWidth = sourceDimensions.w;\n\t    this.sourceHeight = sourceDimensions.h;\n\t\n\t    this.worker = new _worker2.default();\n\t\n\t    this.initialized = false;\n\t\n\t    window.addEventListener('load', this.init.bind(this));\n\t  }\n\t\n\t  _createClass(Diffy, [{\n\t    key: 'toVideo',\n\t    value: function toVideo(blob, videoEl) {\n\t      // piping blob to video element\n\t      videoEl.src = blob;\n\t    }\n\t  }, {\n\t    key: 'toCanvas',\n\t    value: function toCanvas(video, canvas) {\n\t      // piping video to canvas\n\t      canvas.getContext('2d').drawImage(video, 0, 0, canvas.width, canvas.height);\n\t    }\n\t  }, {\n\t    key: 'mirror',\n\t    value: function mirror(canvas) {\n\t      var ctx = canvas.getContext('2d');\n\t      ctx.translate(canvas.width, 0);\n\t      ctx.scale(-1, 1);\n\t      return canvas;\n\t    }\n\t  }, {\n\t    key: 'compare',\n\t    value: function compare(frame1, frame2) {\n\t      var data1 = frame1.data;\n\t      var data2 = frame2.data;\n\t      var length = data1.length;\n\t      var buffer = new ArrayBuffer(length);\n\t\n\t      this.worker.postMessage({\n\t        buffer: buffer,\n\t        data1: data1,\n\t        data2: data2,\n\t        sensitivity: this.sensitivity,\n\t        width: this.sourceWidth,\n\t        height: this.sourceHeight\n\t      });\n\t    }\n\t  }, {\n\t    key: 'drawBlendImageFromBuffer',\n\t    value: function drawBlendImageFromBuffer(buffer) {\n\t      this.blendImageData.data.set(new Uint8ClampedArray(buffer));\n\t\n\t      this.blendCanvasCtx.putImageData(this.blendImageData, 0, 0);\n\t      this.previousImageData = this.currentImageData;\n\t    }\n\t\n\t    /*\n\t      blend two consecutive frames\n\t      returns imageData\n\t    */\n\t\n\t  }, {\n\t    key: 'blend',\n\t    value: function blend(canvas) {\n\t      var ctx = canvas.getContext('2d');\n\t      var width = canvas.width;\n\t      var height = canvas.height;\n\t      this.currentImageData = ctx.getImageData(0, 0, width, height);\n\t      this.previousImageData = this.previousImageData || ctx.getImageData(0, 0, width, height);\n\t      this.compare(this.currentImageData, this.previousImageData);\n\t    }\n\t  }, {\n\t    key: 'createMatrix',\n\t    value: function createMatrix() {\n\t      var i = void 0;\n\t      var j = void 0;\n\t      var posX = void 0;\n\t      var posY = void 0;\n\t      var k = 0;\n\t\n\t      var matrix = [];\n\t      var sourceWidth = this.sourceWidth;\n\t      var sourceHeight = this.sourceHeight;\n\t      var cellWidth = this.sourceWidth / this.resolutionX;\n\t      var cellHeight = this.sourceHeight / this.resolutionY;\n\t\n\t      var cellImageData = null;\n\t      var cellImageDataLength = void 0;\n\t      var cellPixelCount = void 0;\n\t      var average = 0;\n\t\n\t      for (i = 0; i < sourceWidth; i += cellWidth) {\n\t        var row = [];\n\t\n\t        for (j = 0; j < sourceHeight; j += cellHeight) {\n\t          cellImageData = this.blendCanvasCtx.getImageData(i, j, cellWidth, cellHeight).data;\n\t\n\t          /* TODO refactor with bitshifting */\n\t          cellImageDataLength = cellImageData.length;\n\t          cellPixelCount = cellImageDataLength / 4;\n\t          while (k < cellPixelCount) {\n\t            average += (cellImageData[k * 4] + cellImageData[k * 4 + 1] + cellImageData[k * 4 + 2]) / 3;\n\t            ++k;\n\t          }\n\t          average = (0, _utils.round)(average / cellPixelCount);\n\t          /* push the value in the row */\n\t          row.push(average);\n\t          average = 0;\n\t          k = 0;\n\t        }\n\t        matrix.push(row); // store the row in matrix\n\t      }\n\t\n\t      return matrix;\n\t    }\n\t  }, {\n\t    key: 'loop',\n\t    value: function loop() {\n\t      this.toCanvas(this.videoEl, this.rawCanvasEl);\n\t      this.blend(this.rawCanvasEl);\n\t      this.onFrame(this.createMatrix());\n\t      this.tickFn(this.loop.bind(this));\n\t    }\n\t  }, {\n\t    key: 'init',\n\t    value: function init() {\n\t      var _this = this;\n\t\n\t      this.worker.addEventListener('error', function (e) {\n\t        throw e;\n\t      });\n\t\n\t      this.worker.addEventListener('message', function (_ref2) {\n\t        var data = _ref2.data;\n\t\n\t        _this.drawBlendImageFromBuffer(data);\n\t      });\n\t\n\t      this.initDom(this.containerClassName);\n\t      this.blendCanvasCtx = this.blendCanvasEl.getContext('2d');\n\t      this.blendImageData = this.blendCanvasCtx.getImageData(0, 0, this.sourceWidth, this.sourceHeight);\n\t\n\t      this.captureFn(this.captureConfig).then(function (blob) {\n\t        [_this.rawCanvasEl, _this.blendCanvasEl].forEach(_this.mirror);\n\t        _this.toVideo(blob, _this.videoEl);\n\t        _this.loop();\n\t      });\n\t      this.initialized = true;\n\t    }\n\t  }, {\n\t    key: 'createElements',\n\t    value: function createElements(containerClassName) {\n\t      var _this2 = this;\n\t\n\t      this.containerEl = document.createElement('div');\n\t      this.containerEl.className = containerClassName;\n\t\n\t      this.videoEl = document.createElement('video');\n\t      this.videoEl.className = 'video view';\n\t      this.videoEl.setAttribute('autoplay', '');\n\t      this.videoEl.width = this.sourceWidth;\n\t      this.videoEl.height = this.sourceHeight;\n\t\n\t      this.rawCanvasEl = document.createElement('canvas');\n\t      this.rawCanvasEl.className = 'canvas--raw view';\n\t      this.rawCanvasEl.width = this.sourceWidth;\n\t      this.rawCanvasEl.height = this.sourceHeight;\n\t\n\t      this.blendCanvasEl = document.createElement('canvas');\n\t      this.blendCanvasEl.className = 'canvas--blend view';\n\t      this.blendCanvasEl.width = this.sourceWidth;\n\t      this.blendCanvasEl.height = this.sourceHeight;\n\t\n\t      this.headerEl = document.createElement('header');\n\t      this.headerEl.className = 'header';\n\t\n\t      this.titleEl = document.createElement('h1');\n\t      this.titleEl.className = 'title';\n\t      this.titleEl.innerText = 'Diffy debug view';\n\t\n\t      this.toggleEl = document.createElement('span');\n\t      this.toggleEl.className = 'toggle';\n\t      this.toggleEl.innerText = '-';\n\t\n\t      this.headerEl.addEventListener('click', function (ev) {\n\t        ev.preventDefault();\n\t        [_this2.videoEl, _this2.rawCanvasEl, _this2.blendCanvasEl].forEach(function (el) {\n\t          if (_this2.debugViewCollapsed) {\n\t            el.classList.remove('hidden');\n\t            _this2.toggleEl.innerText = '-';\n\t          } else {\n\t            el.classList.add('hidden');\n\t            _this2.toggleEl.innerText = '+';\n\t          }\n\t        });\n\t        _this2.debugViewCollapsed = !_this2.debugViewCollapsed;\n\t      });\n\t\n\t      this.headerEl.appendChild(this.toggleEl);\n\t      this.headerEl.appendChild(this.titleEl);\n\t\n\t      this.containerEl.appendChild(this.headerEl);\n\t      this.containerEl.appendChild(this.videoEl);\n\t      this.containerEl.appendChild(this.rawCanvasEl);\n\t      this.containerEl.appendChild(this.blendCanvasEl);\n\t\n\t      document.body.appendChild(this.containerEl);\n\t\n\t      if (!this.debug) {\n\t        this.containerEl.classList.add('hidden');\n\t      }\n\t    }\n\t  }, {\n\t    key: 'injectCssStyles',\n\t    value: function injectCssStyles() {\n\t      var node = document.createElement('style');\n\t      var containerClassName = this.containerClassName;\n\t      var styles = '\\n      .' + containerClassName + ' {\\n        position: fixed;\\n        top: 0;\\n        left: 0;\\n        font-family: monospace;\\n        background-color: #000;\\n        border: 4px solid #000;\\n        color: #fff;\\n      }\\n      .' + containerClassName + ' .header {\\n        width: 100%;\\n        background-color: #000;\\n        font-size: 16px;\\n        cursor: pointer;\\n      }\\n      .' + containerClassName + ' .title {\\n        display: inline;\\n        margin-left: 10px;\\n        font-weight: 100;\\n        font-size: 16px;\\n      }\\n      .' + containerClassName + ' .toggle {\\n        padding: 5px;\\n      }\\n\\n      .' + containerClassName + ' .view {\\n        padding: 5px;\\n      }\\n\\n      .' + containerClassName + ' .view.hidden {\\n        display: none;\\n      }\\n\\n      .' + containerClassName + '.hidden {\\n        display: none;\\n      }\\n    ';\n\t      node.innerHTML = styles;\n\t      document.body.appendChild(node);\n\t    }\n\t  }, {\n\t    key: 'initDom',\n\t    value: function initDom(containerClassName) {\n\t      this.createElements(containerClassName);\n\t      this.injectCssStyles();\n\t    }\n\t  }], [{\n\t    key: 'create',\n\t    value: function create(options) {\n\t      if (Diffy.instanceExists) {\n\t        throw new Error('\\n        Yikes! It seems like a Diffy.js instance already exists on this page. :|\\n        For more info, see: https://github.com/maniart/diffyjs/blob/master/README.md\\n      ');\n\t      }\n\t\n\t      Diffy.instanceExists = true;\n\t      return new this(options);\n\t    }\n\t  }]);\n\t\n\t  return Diffy;\n\t}();\n\t\n\tDiffy.instanceExists = false;\n\tDiffy.VERSION = '1.0.1';\n\texports.default = Diffy;\n\n/***/ },\n/* 3 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = function() {\n\t\treturn __webpack_require__(4)(\"!function(r){function e(n){if(t[n])return t[n].exports;var o=t[n]={exports:{},id:n,loaded:!1};return r[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var t={};return e.m=r,e.c=t,e.p=\\\"/\\\",e(0)}([function(r,e,t){\\\"use strict\\\";var n=t(1),o=void 0,i=void 0,a=void 0,u=void 0,c=void 0,s=function(r){var e=r.data,t=e.buffer,s=e.data1,d=e.data2,f=e.width,v=e.height,l=e.sensitivity,p=0;c=1-l,o=new Uint32Array(t);for(var g=0;g<v;++g)for(var x=0;x<f;++x)p=g*f+x,i=(s[4*p]+s[4*p+1]+s[4*p+2])/3/c,a=(d[4*p]+d[4*p+1]+d[4*p+2])/3/c,u=(0,n.polarize)((0,n.abs)(i-a),21),o[p]=255<<24|u<<16|u<<8|u;postMessage(t)};onmessage=s},function(r,e){\\\"use strict\\\";Object.defineProperty(e,\\\"__esModule\\\",{value:!0});e.createOnceLog=function(){var r=0;return function(){if(r<1){var e;(e=console).log.apply(e,arguments)}r++}},e.$=function(r){return document.querySelector(r)},e.round=function(r){return r+.5>>0},e.abs=function(r){return(r^r>>31)-(r>>31)},e.polarize=function(r,e){return r>e?0:255}}]);\\n//# sourceMappingURL=a6882b19b6c320d25dad.worker.js.map\", __webpack_require__.p + \"a6882b19b6c320d25dad.worker.js\");\n\t};\n\n/***/ },\n/* 4 */\n/***/ function(module, exports) {\n\n\t// http://stackoverflow.com/questions/10343913/how-to-create-a-web-worker-from-a-string\r\n\t\r\n\tvar URL = window.URL || window.webkitURL;\r\n\tmodule.exports = function(content, url) {\r\n\t\ttry {\r\n\t\t\ttry {\r\n\t\t\t\tvar blob;\r\n\t\t\t\ttry { // BlobBuilder = Deprecated, but widely implemented\r\n\t\t\t\t\tvar BlobBuilder = window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder || window.MSBlobBuilder;\r\n\t\t\t\t\tblob = new BlobBuilder();\r\n\t\t\t\t\tblob.append(content);\r\n\t\t\t\t\tblob = blob.getBlob();\r\n\t\t\t\t} catch(e) { // The proposed API\r\n\t\t\t\t\tblob = new Blob([content]);\r\n\t\t\t\t}\r\n\t\t\t\treturn new Worker(URL.createObjectURL(blob));\r\n\t\t\t} catch(e) {\r\n\t\t\t\treturn new Worker('data:application/javascript,' + encodeURIComponent(content));\r\n\t\t\t}\r\n\t\t} catch(e) {\r\n\t\t\treturn new Worker(url);\r\n\t\t}\r\n\t}\n\n/***/ },\n/* 5 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t/* eslint-disable no-console */\n\t\n\t/*\n\t  utility function to log only once\n\t  useful for logging in loops\n\t*/\n\tvar createOnceLog = exports.createOnceLog = function createOnceLog() {\n\t  var counter = 0;\n\t  return function onceLog() {\n\t    if (counter < 1) {\n\t      var _console;\n\t\n\t      (_console = console).log.apply(_console, arguments);\n\t    }\n\t    counter++;\n\t  };\n\t};\n\t\n\t/*\n\t  utility function to access DOM references\n\t*/\n\tvar $ = exports.$ = function $(selector) {\n\t  return document.querySelector(selector);\n\t};\n\t\n\t/*\n\t  bitwise Math.round\n\t*/\n\tvar round = exports.round = function round(number) {\n\t  return number + .5 >> 0;\n\t};\n\t\n\t/*\n\t  butwise Math.abs\n\t*/\n\tvar abs = exports.abs = function abs(value) {\n\t  return (value ^ value >> 31) - (value >> 31);\n\t};\n\t\n\t/*\n\t  polarize pixel values based on value and threshold\n\t*/\n\tvar polarize = exports.polarize = function polarize(value, threshold) {\n\t  return value > threshold ? 0x00 : 0XFF;\n\t};\n\n/***/ },\n/* 6 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t/*\n\t  shim requestAnimationFrame api\n\t  source: http://www.paulirish.com/2011/requestanimationframe-for-smart-animating/\n\t*/\n\tvar requestAnimFrame = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || function (callback) {\n\t  window.setTimeout(callback, 1000 / 60);\n\t};\n\t\n\texports.default = requestAnimFrame;\n\n/***/ },\n/* 7 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t/* eslint-disable no-unused-vars */\n\t/* eslint-disable no-console */\n\t/*\n\t  shim getUserMedia with a Promise api\n\t  source: https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia\n\t*/\n\tvar getUserMedia = function getUserMedia(constraints, successCallback, errorCallback) {\n\t\n\t  // First get a hold of getUserMedia, if present\n\t  var getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia;\n\t\n\t  // Some browsers just don't implement it - return a rejected promise with an error\n\t  // to keep a consistent interface\n\t  if (!getUserMedia) {\n\t    return Promise.reject(new Error('getUserMedia is not implemented in this browser'));\n\t  }\n\t\n\t  // Otherwise, wrap the call to the old navigator.getUserMedia with a Promise\n\t  return new Promise(function (successCallback, errorCallback) {\n\t    getUserMedia.call(navigator, constraints, successCallback, errorCallback);\n\t  });\n\t};\n\t\n\t// Older browsers might not implement mediaDevices at all, so we set an empty object first\n\tif (navigator.mediaDevices === undefined) {\n\t  navigator.mediaDevices = {};\n\t}\n\t\n\t// Some browsers partially implement mediaDevices. We can't just assign an object\n\t// with getUserMedia as it would overwrite existing properties.\n\t// Here, we will just add the getUserMedia property if it's missing.\n\tif (navigator.mediaDevices.getUserMedia === undefined) {\n\t  navigator.mediaDevices.getUserMedia = getUserMedia;\n\t}\n\t\n\t/*\n\t  capture from camera\n\t  returns objectUrl\n\t */\n\tvar capture = function capture(constraints) {\n\t  return navigator.mediaDevices.getUserMedia(constraints).then(function (stream) {\n\t    return window.URL.createObjectURL(stream);\n\t  }).catch(function (_ref) {\n\t    var name = _ref.name,\n\t        message = _ref.message;\n\t    return console.error(name + ' : ' + message);\n\t  });\n\t};\n\t\n\texports.default = capture;\n\n/***/ }\n/******/ ])\n});\n;\n\n\n// WEBPACK FOOTER //\n// diffy.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 275379919d2da25a6fea","/* eslint-disable no-console */\n\nimport Diffy from './Diffy';\nimport requestAnimFrame from './raf';\nimport capture from './capture';\n\nexport const create = ({ resolution, sensitivity, debug, onFrame }) => {\n\n  if(!window) {\n    throw new Error(`\n      Diffy.js is meant to be used in the browser. :^)\n      For more info, see: https://github.com/maniart/diffyjs/blob/master/README.md\n    `);\n  }\n\n  if(!'Worker' in window) {\n    throw new Error(`\n      Diffy.js requires Web Workers.\n      It looks like this environment does not support this feature. :(\n      For more info, see: https://github.com/maniart/diffyjs/blob/master/README.md\n    `);\n  }\n\n  return Diffy.create({\n    tickFn: requestAnimFrame,\n    captureFn: capture,\n    resolution,\n    sensitivity,\n    debug,\n    onFrame\n  });\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","import Worker from 'worker-loader?inline!./worker';\nimport { createOnceLog, $, round } from './utils';\n\n// tmp\nconst logger_1 = createOnceLog();\nconst logger_2 = createOnceLog();\n\nexport default class Diffy {\n  constructor({\n    tickFn = () => {},\n    captureFn = () => {},\n    captureConfig = {\n      audio: false,\n      video: {\n        width: 130,\n        height: 100\n      }\n    },\n    debug = false,\n    sourceDimensions = { w: 130, h: 100 },\n    onFrame = (matrix) => {},\n    sensitivity = 0.2,\n    containerClassName = 'diffy--debug-view',\n    resolution = { x: 10, y: 5 }\n  }) {\n\n\n    this.tickFn = tickFn.bind(window);\n    this.captureFn = captureFn;\n\n    this.onFrame = onFrame;\n\n    this.currentImageData = null;\n    this.previousImageData = null;\n\n    this.resolutionX = resolution.x;\n    this.resolutionY = resolution.y;\n\n    this.sensitivity = sensitivity;\n\n    this.debug = debug;\n    this.containerClassName = containerClassName;\n    this.debugViewCollapsed = false;\n\n    this.captureConfig = captureConfig;\n\n    this.sourceWidth = sourceDimensions.w;\n    this.sourceHeight = sourceDimensions.h;\n\n    this.worker = new Worker;\n\n    this.initialized = false;\n\n    window.addEventListener('load', this.init.bind(this));\n  }\n\n  static instanceExists = false;\n  static VERSION = '1.0.1';\n\n  toVideo(blob, videoEl) {\n    // piping blob to video element\n    videoEl.src = blob;\n  }\n\n  toCanvas(video, canvas) {\n    // piping video to canvas\n    canvas\n      .getContext('2d')\n      .drawImage(video, 0, 0, canvas.width, canvas.height);\n  }\n\n\n  mirror(canvas) {\n    const ctx = canvas.getContext('2d');\n    ctx.translate(canvas.width, 0);\n    ctx.scale(-1, 1);\n    return canvas;\n  }\n\n  compare(frame1, frame2) {\n    const data1 = frame1.data;\n    const data2 = frame2.data;\n    const length = data1.length;\n    const buffer = new ArrayBuffer(length);\n\n    this.worker.postMessage({\n      buffer,\n      data1,\n      data2,\n      sensitivity: this.sensitivity,\n      width: this.sourceWidth,\n      height: this.sourceHeight\n    });\n  }\n\n  drawBlendImageFromBuffer(buffer) {\n    this.blendImageData\n      .data\n      .set(\n        new Uint8ClampedArray(buffer)\n      );\n\n    this.blendCanvasCtx.putImageData(this.blendImageData, 0, 0);\n    this.previousImageData = this.currentImageData;\n  }\n\n  /*\n    blend two consecutive frames\n    returns imageData\n  */\n  blend(canvas) {\n    const ctx = canvas.getContext('2d');\n    const width = canvas.width;\n    const height = canvas.height;\n    this.currentImageData = ctx.getImageData(0, 0, width, height);\n    this.previousImageData = this.previousImageData || ctx.getImageData(0, 0, width, height);\n    this.compare(this.currentImageData, this.previousImageData);\n  }\n\n  createMatrix() {\n    let i;\n    let j;\n    let posX;\n    let posY;\n    let k = 0;\n\n    const matrix = [];\n    const sourceWidth = this.sourceWidth;\n    const sourceHeight = this.sourceHeight;\n    const cellWidth = this.sourceWidth / this.resolutionX;\n    const cellHeight = this.sourceHeight / this.resolutionY;\n\n\n    let cellImageData = null;\n    let cellImageDataLength;\n    let cellPixelCount;\n    let average = 0;\n\n    for(i = 0; i < sourceWidth; i += cellWidth) {\n      let row = [];\n\n      for(j = 0; j < sourceHeight; j += cellHeight) {\n        cellImageData = this.blendCanvasCtx.getImageData(i, j, cellWidth, cellHeight).data;\n\n        /* TODO refactor with bitshifting */\n        cellImageDataLength = cellImageData.length;\n        cellPixelCount = cellImageDataLength / 4;\n        while(k < cellPixelCount) {\n          average += (cellImageData[k * 4] + cellImageData[k * 4 + 1] + cellImageData[k * 4 + 2]) / 3;\n          ++ k;\n        }\n        average = round(average / cellPixelCount);\n        /* push the value in the row */\n        row.push(average);\n        average = 0;\n        k = 0;\n      }\n      matrix.push(row); // store the row in matrix\n    }\n\n    return matrix;\n  }\n\n  loop() {\n    this.toCanvas(this.videoEl, this.rawCanvasEl);\n    this.blend(this.rawCanvasEl);\n    this.onFrame(this.createMatrix());\n    this.tickFn(this.loop.bind(this));\n  }\n\n  init() {\n\n    this.worker.addEventListener('error', (e) => {\n      throw e;\n    });\n\n    this.worker.addEventListener('message', ({ data }) => {\n      this.drawBlendImageFromBuffer(data);\n    });\n\n    this.initDom(this.containerClassName);\n    this.blendCanvasCtx = this.blendCanvasEl.getContext('2d');\n    this.blendImageData = this.blendCanvasCtx.getImageData(0, 0, this.sourceWidth, this.sourceHeight);\n\n    this.captureFn(this.captureConfig).then((blob) => {\n      [this.rawCanvasEl, this.blendCanvasEl].forEach(this.mirror);\n      this.toVideo(blob, this.videoEl);\n      this.loop();\n    });\n    this.initialized = true;\n  }\n\n  createElements(containerClassName) {\n    this.containerEl = document.createElement('div');\n    this.containerEl.className = containerClassName;\n\n    this.videoEl = document.createElement('video');\n    this.videoEl.className = 'video view';\n    this.videoEl.setAttribute('autoplay', '');\n    this.videoEl.width = this.sourceWidth;\n    this.videoEl.height = this.sourceHeight;\n\n    this.rawCanvasEl = document.createElement('canvas');\n    this.rawCanvasEl.className = 'canvas--raw view';\n    this.rawCanvasEl.width = this.sourceWidth;\n    this.rawCanvasEl.height = this.sourceHeight;\n\n    this.blendCanvasEl = document.createElement('canvas');\n    this.blendCanvasEl.className = 'canvas--blend view';\n    this.blendCanvasEl.width = this.sourceWidth;\n    this.blendCanvasEl.height = this.sourceHeight;\n\n    this.headerEl = document.createElement('header');\n    this.headerEl.className = 'header';\n\n    this.titleEl = document.createElement('h1');\n    this.titleEl.className = 'title';\n    this.titleEl.innerText = 'Diffy debug view';\n\n    this.toggleEl = document.createElement('span');\n    this.toggleEl.className = 'toggle';\n    this.toggleEl.innerText = '-';\n\n    this.headerEl.addEventListener('click', (ev) => {\n      ev.preventDefault();\n      [this.videoEl, this.rawCanvasEl, this.blendCanvasEl].forEach((el) => {\n        if (this.debugViewCollapsed) {\n          el.classList.remove('hidden');\n          this.toggleEl.innerText = '-';\n        } else {\n          el.classList.add('hidden');\n          this.toggleEl.innerText = '+';\n        }\n      });\n      this.debugViewCollapsed = !this.debugViewCollapsed;\n    });\n\n    this.headerEl.appendChild(this.toggleEl);\n    this.headerEl.appendChild(this.titleEl);\n\n    this.containerEl.appendChild(this.headerEl);\n    this.containerEl.appendChild(this.videoEl);\n    this.containerEl.appendChild(this.rawCanvasEl);\n    this.containerEl.appendChild(this.blendCanvasEl);\n\n    document.body.appendChild(this.containerEl);\n\n    if (!this.debug) {\n      this.containerEl.classList.add('hidden');\n    }\n  }\n\n  injectCssStyles() {\n    const node = document.createElement('style');\n    const containerClassName = this.containerClassName;\n    const styles = `\n      .${containerClassName} {\n        position: fixed;\n        top: 0;\n        left: 0;\n        font-family: monospace;\n        background-color: #000;\n        border: 4px solid #000;\n        color: #fff;\n      }\n      .${containerClassName} .header {\n        width: 100%;\n        background-color: #000;\n        font-size: 16px;\n        cursor: pointer;\n      }\n      .${containerClassName} .title {\n        display: inline;\n        margin-left: 10px;\n        font-weight: 100;\n        font-size: 16px;\n      }\n      .${containerClassName} .toggle {\n        padding: 5px;\n      }\n\n      .${containerClassName} .view {\n        padding: 5px;\n      }\n\n      .${containerClassName} .view.hidden {\n        display: none;\n      }\n\n      .${containerClassName}.hidden {\n        display: none;\n      }\n    `;\n    node.innerHTML = styles;\n    document.body.appendChild(node);\n  }\n\n  initDom(containerClassName) {\n    this.createElements(containerClassName);\n    this.injectCssStyles();\n  }\n\n  static create(options) {\n    if (Diffy.instanceExists) {\n      throw new Error(`\n        Yikes! It seems like a Diffy.js instance already exists on this page. :|\n        For more info, see: https://github.com/maniart/diffyjs/blob/master/README.md\n      `);\n    }\n\n    Diffy.instanceExists = true;\n    return new this(options);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/Diffy.js","module.exports = function() {\n\treturn require(\"!!/Users/maninilchiani/Self/diffyjs/node_modules/worker-loader/createInlineWorker.js\")(\"!function(r){function e(n){if(t[n])return t[n].exports;var o=t[n]={exports:{},id:n,loaded:!1};return r[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var t={};return e.m=r,e.c=t,e.p=\\\"/\\\",e(0)}([function(r,e,t){\\\"use strict\\\";var n=t(1),o=void 0,i=void 0,a=void 0,u=void 0,c=void 0,s=function(r){var e=r.data,t=e.buffer,s=e.data1,d=e.data2,f=e.width,v=e.height,l=e.sensitivity,p=0;c=1-l,o=new Uint32Array(t);for(var g=0;g<v;++g)for(var x=0;x<f;++x)p=g*f+x,i=(s[4*p]+s[4*p+1]+s[4*p+2])/3/c,a=(d[4*p]+d[4*p+1]+d[4*p+2])/3/c,u=(0,n.polarize)((0,n.abs)(i-a),21),o[p]=255<<24|u<<16|u<<8|u;postMessage(t)};onmessage=s},function(r,e){\\\"use strict\\\";Object.defineProperty(e,\\\"__esModule\\\",{value:!0});e.createOnceLog=function(){var r=0;return function(){if(r<1){var e;(e=console).log.apply(e,arguments)}r++}},e.$=function(r){return document.querySelector(r)},e.round=function(r){return r+.5>>0},e.abs=function(r){return(r^r>>31)-(r>>31)},e.polarize=function(r,e){return r>e?0:255}}]);\\n//# sourceMappingURL=a6882b19b6c320d25dad.worker.js.map\", __webpack_public_path__ + \"a6882b19b6c320d25dad.worker.js\");\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/worker-loader?inline!./src/worker.js\n// module id = 3\n// module chunks = 0","// http://stackoverflow.com/questions/10343913/how-to-create-a-web-worker-from-a-string\r\n\r\nvar URL = window.URL || window.webkitURL;\r\nmodule.exports = function(content, url) {\r\n\ttry {\r\n\t\ttry {\r\n\t\t\tvar blob;\r\n\t\t\ttry { // BlobBuilder = Deprecated, but widely implemented\r\n\t\t\t\tvar BlobBuilder = window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder || window.MSBlobBuilder;\r\n\t\t\t\tblob = new BlobBuilder();\r\n\t\t\t\tblob.append(content);\r\n\t\t\t\tblob = blob.getBlob();\r\n\t\t\t} catch(e) { // The proposed API\r\n\t\t\t\tblob = new Blob([content]);\r\n\t\t\t}\r\n\t\t\treturn new Worker(URL.createObjectURL(blob));\r\n\t\t} catch(e) {\r\n\t\t\treturn new Worker('data:application/javascript,' + encodeURIComponent(content));\r\n\t\t}\r\n\t} catch(e) {\r\n\t\treturn new Worker(url);\r\n\t}\r\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/worker-loader/createInlineWorker.js\n// module id = 4\n// module chunks = 0","/* eslint-disable no-console */\n\n/*\n  utility function to log only once\n  useful for logging in loops\n*/\nexport const createOnceLog = () => {\n  let counter = 0;\n  return function onceLog() {\n    if(counter < 1) {\n      console.log(...arguments);\n    }\n    counter ++;\n  }\n}\n\n/*\n  utility function to access DOM references\n*/\nexport const $ = (selector) => document.querySelector(selector);\n\n/*\n  bitwise Math.round\n*/\nexport const round = (number) => (number + .5) >> 0;\n\n/*\n  butwise Math.abs\n*/\nexport const abs = (value) => (value ^ (value >> 31)) - (value >> 31);\n\n\n/*\n  polarize pixel values based on value and threshold\n*/\nexport const polarize = (value, threshold) => (value > threshold) ? 0x00 : 0XFF;\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils.js","/*\n  shim requestAnimationFrame api\n  source: http://www.paulirish.com/2011/requestanimationframe-for-smart-animating/\n*/\nconst requestAnimFrame =\n  window.requestAnimationFrame       ||\n  window.webkitRequestAnimationFrame ||\n  window.mozRequestAnimationFrame    ||\n  window.oRequestAnimationFrame      ||\n  window.msRequestAnimationFrame     ||\n  function(callback) {\n    window.setTimeout(callback, 1000 / 60);\n  };\n\nexport default requestAnimFrame;\n\n\n\n// WEBPACK FOOTER //\n// ./src/raf.js","/* eslint-disable no-unused-vars */\n/* eslint-disable no-console */\n/*\n  shim getUserMedia with a Promise api\n  source: https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia\n*/\nconst getUserMedia = (constraints, successCallback, errorCallback) => {\n\n  // First get a hold of getUserMedia, if present\n  const getUserMedia = (navigator.getUserMedia ||\n      navigator.webkitGetUserMedia ||\n      navigator.mozGetUserMedia);\n\n  // Some browsers just don't implement it - return a rejected promise with an error\n  // to keep a consistent interface\n  if(!getUserMedia) {\n    return Promise.reject(new Error('getUserMedia is not implemented in this browser'));\n  }\n\n  // Otherwise, wrap the call to the old navigator.getUserMedia with a Promise\n  return new Promise((successCallback, errorCallback) => {\n    getUserMedia.call(navigator, constraints, successCallback, errorCallback);\n  });\n\n}\n\n// Older browsers might not implement mediaDevices at all, so we set an empty object first\nif(navigator.mediaDevices === undefined) {\n  navigator.mediaDevices = {};\n}\n\n// Some browsers partially implement mediaDevices. We can't just assign an object\n// with getUserMedia as it would overwrite existing properties.\n// Here, we will just add the getUserMedia property if it's missing.\nif(navigator.mediaDevices.getUserMedia === undefined) {\n  navigator.mediaDevices.getUserMedia = getUserMedia;\n}\n\n/*\n  capture from camera\n  returns objectUrl\n */\nconst capture = (constraints) => {\n  return navigator.mediaDevices.getUserMedia(constraints)\n    .then((stream) => window.URL.createObjectURL(stream))\n    .catch(({ name, message }) => console.error(`${name} : ${message}`));\n}\n\nexport default capture;\n\n\n\n// WEBPACK FOOTER //\n// ./src/capture.js"],"sourceRoot":""}